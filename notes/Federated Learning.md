---
attachments: [Clipboard_2022-06-15-13-54-19.png, Clipboard_2022-06-15-13-57-53.png, Clipboard_2022-06-15-14-03-27.png, Clipboard_2022-06-15-14-22-55.png, Clipboard_2022-06-15-14-31-58.png, Clipboard_2022-06-15-14-32-03.png]
tags: [联邦学习, 实习笔记]
title: Federated Learning
created: '2022-06-14T08:40:12.318Z'
modified: '2022-06-15T06:42:30.102Z'
---

# Federated Learning
联邦学习也称为协同学习，它可以在产生数据的设备上进行大规模的训练，并且这些敏感数据保留在数据的所有者那里，本地收集、本地训练。在本地训练后，中央的训练协调器通过获取分布模型的更新获得每个节点的训练贡献，但是不访问实际的敏感数据。

**联邦学习**使得隐私成为可能。隐私是联邦学习的基本属性之一。

- [安全多方计算（Secure Multi-party Computation，SMC)](https://zhuanlan.zhihu.com/p/384759946)
- [差分隐私 （Differential Privacy，DP）](https://zhuanlan.zhihu.com/p/139114240)
- [同态加密（Homomorphic Encryption）](https://zhuanlan.zhihu.com/p/77478956)

## 联邦学习种类

### 横向（水平）联邦学习
水平联邦学习（Horizontal Federated Learning），或基于样本的联邦学习，是在数据集共享相同的特征空间但样本不同的情况下引入的。例如，两个区域性银行可能有来自各自区域的非常不同的用户群，而且他们的用户的交集非常小。然而，他们的业务非常相似，所以特征空间相同。2017年，谷歌提出了一个用于安卓手机模型更新的水平联邦学习方法。在该框架中，使用安卓手机的个体用户在本地更新模型参数，并将参数上传到安卓云，从而与其他数据所有者一起联合训练集中式模型。还介绍了一种安全的聚合方案，以保护其联合学习框架下聚合的用户更新的隐私。
![HFL](@attachment/Clipboard_2022-06-15-13-54-19.png)

水平联邦学习的特点：
- 相同的特征
- 相同的标签
- 不同的样本

#### 水平联邦学习的架构
![](@attachment/Clipboard_2022-06-15-14-03-27.png)
在这个系统中，具有相同数据结构的k个参与者在一个参数或云服务器的帮助下协作学习一个机器学习模型。一个典型的假设是，用户端是安全的，服务器端可能是安全的，因此不允许任何参与者的信息泄露给服务器。这样一个系统的训练过程通常包含以下四个步骤。

- 参与者在本地计算梯度，用加密（差分隐私）掩盖部分梯度。将遮蔽的结果发送给服务器。
- 服务器在不了解任何参与者信息的情况下进行安全的梯度聚合。
- 服务器将梯度汇总后的结果发回给参与者。
- 参与者用解密的梯度更新他们各自的模型。
- 重复上述步骤，直到模型收敛

### 垂直联邦学习
垂直联邦学习（Vertical Federated Learning）或基于特征的联合学习适用于**两个数据集共享相同的样本 ID 空间**但在特征空间不同的情况。例如，考虑同一城市的两家不同公司，一家是银行，另一家是电子商务公司。他们的用户集可能包含该地区的大部分居民，所以他们的用户空间的交集很大。然而，由于银行记录了用户的收支行为和信用等级，而电子商务保留了用户的浏览和购买历史，他们的特征空间是非常不同的。假设希望双方都能有一个基于用户和产品信息的产品购买预测模型。
![VFL](@attachment/Clipboard_2022-06-15-13-57-53.png)

垂直联邦学习的特点：
- 相同的样本用例
- 不同的特征

### 垂直联邦学习的架构
![](@attachment/Clipboard_2022-06-15-14-22-55.png)
加密的实体对齐（Encrypted entity alignment）。由于两家公司的用户群不一样，系统使用基于加密的用户 ID 对齐技术，在不暴露 A 和 B 各自数据的情况下确认双方的共同用户。在实体对齐过程中，系统不会暴露彼此不重合的用户。
![](@attachment/Clipboard_2022-06-15-14-32-03.png)
在确定共同实体后，可以使用这些共同实体的数据来训练机器学习模型。训练过程可以分为以下四个步骤

![](@attachment/Clipboard_2022-06-15-14-31-58.png)

- 

